<!-- ENVOLVE BOT CODE SNIPPET -->
<script>
	(function () {
		var envolveChatWidgetScript = document.createElement("script");
		envolveChatWidgetScript.setAttribute(
			"src",
			"https://widget.envolvetech.com/static/js/app.js"
		);
		envolveChatWidgetScript.setAttribute(
			"data-identifier",
			"ag9lbnZvbHZldGVjaC0wMDFyHQsSEENoYXRXaWRnZXRDb25maWcYgICA7p73lwoM"
		);
		envolveChatWidgetScript.setAttribute(
			"data-backend",
			"https://bot-dot-envolvetech-001.appspot.com"
		);
		document.body.appendChild(envolveChatWidgetScript);
	})();
</script>

<!-- SALESFORCE EMBEDDED SERVICE DEPLOYMENT CODE SNIPPET -->
<style type="text/css">
	.embeddedServiceHelpButton .helpButton .uiButton {
		background-color: #000000;
		font-family: "Aaux Pro Regular", sans-serif;
	}
	.embeddedServiceHelpButton .helpButton .uiButton:focus {
		outline: 1px solid #000000;
	}
</style>

<script
	type="text/javascript"
	src="https://service.force.com/embeddedservice/5.0/esw.min.js"></script>
<script type="text/javascript">
	var initESW = function (gslbBaseURL) {
		embedded_svc.settings.displayHelpButton = false; //Or false
		embedded_svc.settings.language = ""; //For example, enter 'en' or 'en-US'

		embedded_svc.settings.defaultMinimizedText = "CHAT W/ CUB"; //(Defaults to Chat with an Expert)
		//embedded_svc.settings.disabledMinimizedText = '...'; //(Defaults to Agent Offline)

		//embedded_svc.settings.loadingText = ''; //(Defaults to Loading)
		//embedded_svc.settings.storageDomain = 'yourdomain.com'; //(Sets the domain for your deployment so that visitors can navigate subdomains during a chat session)

		// Settings for Chat
		//embedded_svc.settings.directToButtonRouting = function(prechatFormData) {
		// Dynamically changes the button ID based on what the visitor enters in the pre-chat form.
		// Returns a valid button ID.
		//};
		//embedded_svc.settings.prepopulatedPrechatFields = {}; //Sets the auto-population of pre-chat form fields
		//embedded_svc.settings.fallbackRouting = []; //An array of button IDs, user IDs, or userId_buttonId
		//embedded_svc.settings.offlineSupportMinimizedText = '...'; //(Defaults to Contact Us)

		embedded_svc.settings.enabledFeatures = ["LiveAgent"];
		embedded_svc.settings.entryFeature = "LiveAgent";
		//the snippet of code below does 3 things: matches to salesforce contacts exactly on email, creates a new contact if no match found, and links the chat to the matched or created contact

		embedded_svc.settings.extraPrechatInfo = [
			{
				entityFieldMaps: [
					{
						doCreate: true,
						doFind: false,
						fieldName: "LastName",
						isExactMatch: false,
						label: "Last Name",
					},
					{
						doCreate: true,
						doFind: false,
						fieldName: "FirstName",
						isExactMatch: false,
						label: "First Name",
					},
					{
						doCreate: true,
						doFind: true,
						fieldName: "Email",
						isExactMatch: true,
						label: "Email",
					},
					{
						doCreate: true,
						doFind: false,
						fieldName: "Phone",
						isExactMatch: false,
						label: "Phone",
					},
				],
				entityName: "Contact",
				saveToTranscript: "Contact",
				showOnCreate: true,
			},
		];
		//the snippet below leverages a custom label to set the brand logo on the survey page
		embedded_svc.settings.extraPrechatFormDetails = [
			{ label: "brandLogo", value: "cubCadetLogo.jpg", displayToAgent: false },
		];
		embedded_svc.settings.autoOpenPostChat = true;

		//the urls for salesforce, gslbBaseUrl, baseLiveAgentContactURL, DeploymentId, buttonId, baseLiveAgentURL, eswLiveAgentDevName all change in different salesforce environments. When an embedded service is generated from the target environment these are populated automatically

		//Re-display the Evolvebot bot when chat is closed by the Visitor (clicks the X to close the chat window)
		embedded_svc.addEventHandler("afterDestroy", function (data) {
			document.getElementsByClassName(
				"envolve-sc-chat-window"
			)[0].style.display = "block";
			document.getElementsByClassName(
				"envolve-sc-custom-launcher"
			)[0].style.display = "";
		});

		//Keep the Evolvebot chat hidden when the SF chat is minimized
		embedded_svc.addEventHandler("afterMinimize", function (data) {
			document.getElementsByClassName(
				"envolve-sc-chat-window"
			)[0].style.display = "none";
			document.getElementsByClassName(
				"envolve-sc-custom-launcher"
			)[0].style.display = "";
		});

		embedded_svc.init(
			"https://mtdproducts.my.salesforce.com",
			"https://support.cubcadet.com/",
			gslbBaseURL,
			"00DA0000000hHew",
			"Cub_Cadet_VSA",
			{
				baseLiveAgentContentURL:
					"https://c.la2-c2-ph2.salesforceliveagent.com/content",
				deploymentId: "5722G000000blJi",
				buttonId: "5732G000000fxa6",
				baseLiveAgentURL: "https://d.la2-c2-ph2.salesforceliveagent.com/chat",
				eswLiveAgentDevName:
					"EmbeddedServiceLiveAgent_Parent04I7j000000CaZ6EAK_17e55a80a5d",
				isOfflineSupportEnabled: false,
			}
		);
	};

	if (!window.embedded_svc) {
		var s = document.createElement("script");
		s.setAttribute(
			"src",
			"https://mtdproducts.my.salesforce.com/embeddedservice/5.0/esw.min.js"
		);
		s.onload = function () {
			initESW(null);
		};
		document.body.appendChild(s);
	} else {
		initESW("https://service.force.com");
	}
</script>
